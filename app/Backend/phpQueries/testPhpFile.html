<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Homepage</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        $(document).ready(function () {
            $("#fetchData").click(function () {
                $('#loading').show(); // Show loading indicator
                var phpFileName = "<?php echo basename($pathToPhpFile); ?>"; // Get the name of the PHP file
                var phpFilePath = "<?php echo $pathToPhpFile; ?>"; // Path to PHP file defined in index.php
                $.ajax({
                    url: phpFilePath,
                    type: 'GET',
                    dataType: 'json',
                    success: function (data) {
                        if (data.length > 0) {
                            let resultHtml = '<table border="1"><tr>';
                            // Generate table headers based on the keys of the first row
                            $.each(data[0], function (key, value) {
                                resultHtml += '<th>' + key + '</th>';
                            });
                            resultHtml += '</tr>';
                            // Generate table rows and cells
                            $.each(data, function (index, row) {
                                resultHtml += '<tr>';
                                $.each(row, function (key, value) {
                                    resultHtml += '<td>' + value + '</td>';
                                });
                                resultHtml += '</tr>';
                            });
                            resultHtml += '</table>';
                            $('#result').html(resultHtml);
                        } else {
                            $('#result').html('No data available');
                        }
                    },
                    error: function (xhr, status, error) {
                        $('#result').html('Error: ' + error);
                    },
                    complete: function () {
                        $('#loading').hide(); // Hide loading indicator when request is complete
                    }
                });
            });
        });
    </script>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }

        th,
        td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }

        #loading {
            display: none;
            margin-top: 20px;
        }
    </style>
</head>

<body>
    <h1>Test a specific PHP file</h1>
    <!-- Button text dynamically generated -->
    <button id="fetchData">Fetch Data from
        <?php echo basename($pathToPhpFile); ?>
    </button>
    <div id="loading">Loading...</div>
    <div id="result"></div>
</body>

</html>